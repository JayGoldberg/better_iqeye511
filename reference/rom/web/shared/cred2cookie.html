<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Visicon Authentication</title>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<script language="JavaScript" type="text/javascript">
<!--



function SetCookie(name, value) {
    var argv = SetCookie.arguments;
    var argc = SetCookie.arguments.length;
    var path    = (argc > 2) ? argv[2] : null;
    var expires = (argc > 3) ? argv[3] : null;
    var domain  = (argc > 4) ? argv[4] : null;
    var secure  = (argc > 5) ? argv[5] : false;
    document.cookie = name + "=" + escape (value) +
	((expires == null) ? "" : ("; expires=" + expires.toGMTString())) +
	((path    == null) ? "" : ("; path=" + path)) +
	((domain  == null) ? "" : ("; domain=" + domain)) +
	((secure  == true) ? "; secure" : "");
}

function getSearchVar(search,str) {
    var offset,end;
    offset=str.indexOf(search);
    if (offset != -1) {
        offset += search.length; 
	end = str.indexOf("&", offset);
	if (end == -1) 
	   end = str.length;
	return unescape(str.substring(offset,end));
    }
    return "";
}

function autorun() {
    var str=window.location.search; 
    var cred=getSearchVar("c=",str); 
    var page=getSearchVar("p=",str); 

    if(cred.length==0 || page.length==0) {
        window.alert("ERROR: credentials & destination page must be set.");
        return;
    }
    SetCookie("VisIQnCreds", cred, "/");

    
    
    
    
    SetCookie("SrvrCreds", cred, "/"); 
    
    window.location.href = page;
}

</script>
</head>
<body onload="autorun()">
</body>
</html>

